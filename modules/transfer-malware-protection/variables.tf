variable "s3_ingest_bucket" {
  type = object({
    bucket_name     = string
    object_prefixes = list(string)
  })
  description = "S3 bucket and prefixes to protect with GuardDuty malware scanning (ingest bucket)"
}

variable "delete_processed_file_from_ingest_bucket" {
  type        = bool
  description = "Whether to delete the file in the ingest bucket after scanning (true) or retain them (false)"
  default     = false
}

variable "name_prefix" {
  type        = string
  description = "Prefix for resource names"
}

variable "buckets_kms_key_arn" {
  type        = string
  description = "ARN of KMS key used for S3 bucket encryption"
  default     = null
}

variable "create_kms_key_for_lambda_sqs" {
  type        = bool
  description = "Whether to create a new KMS key for Lambda and SQS encryption"
  default     = true
}

variable "create_sqs_dlq" {
  type        = bool
  description = "Whether to create SQS dead letter queue"
  default     = true
}

variable "tags" {
  type        = map(string)
  description = "Tags to apply to resources"
  default     = {}
}

variable "vpc_subnet_ids" {
  description = "List of VPC subnet IDs for Lambda function"
  type        = list(string)
  default     = null
}

variable "vpc_security_group_ids" {
  description = "List of VPC security group IDs for Lambda function"
  type        = list(string)
  default     = null
}

variable "code_signing_config_arn" {
  description = "ARN of the code signing configuration for Lambda function"
  type        = string
  default     = null
}

variable "routing_config" {
  description = "Mapping of GuardDuty scan results to S3 destination paths"
  type        = map(string)
  default = {
    "NO_THREATS_FOUND" = null
    "THREATS_FOUND"    = null
    "UNSUPPORTED"      = null
    "ACCESS_DENIED"    = null
    "FAILED"           = null
  }
}

variable "enable_sqs_buffer" {
  description = "Enable SQS buffer between EventBridge and Lambda for improved reliability"
  type        = bool
  default     = true
}
